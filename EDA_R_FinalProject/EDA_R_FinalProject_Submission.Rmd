Exploration of WA DOH School Exemption Data over 3 School Years by Andrew T. Bauman
========================================================
#Introduction#

Recent news media coverage and my own personal interest inspired me to explore a school vaccination data set for WA state.  WA DOH employees generously assembled 3 data sets for my project for school years 2011-2012, 2012-2013, and 2013-2014.  The 2011-2012 set is the most comprehensive in terms of school covered and relevant fields  Each data set contains an observation about a school.  The 3 data sets were bound into one data set, then explored.  

The initial data and cleaning/assembly of the combined data frame can be found here:
[githubrepo](https://github.com/baumanab/EDA_R_Udacity/tree/master/EDA_R_FinalProject/EDA_R_FinalProject.Rmd)

Additional cleaning and wrangling can be found here:

[githubrepo](https://github.com/baumanab/EDA_R_Udacity/blob/master/EDA_R_FinalProject/EDA_R_FinalProject_WADOH_DataFrameWrangle.Rmd)

An initial exploration wherein I make decisions about subsetting data for this RMD is and some additoinal corrections for student enrollment, is here:

[githubrepo](https://github.com/baumanab/EDA_R_Udacity/blob/master/EDA_R_FinalProject/WADOH_DataExplore.Rmd)


The current state is a rough approach and far from perfect.  I plan to revisit this as I discover additional elements that need cleaning.  I am currently working on a more readable and organized version of the data wrangling which involves piping/chaining the code together, so that changes are easy to make and push to the .rds file called as data for this project.

**Disclaimer:**
While I am a trained scientist, I am not an expert statistician or programmer.  This is a student project.  My data cleaning and wrangling has room for improvement.  As such, please exercise caution and good judgement regarding my observations and conclusions.  **Feedback on any aspect of this project is encouraged and most welcome.**

There are some aspects of vaccination and the spread of disease through populations that are best left to subject matter experts (SMEs).  I consulted CDC publications throughout this analysis and I encourage the reader to do the same.
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load libraries

library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)
library(GGally)
library(reshape2)
library(tidyr)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data, initial wrangle/clean with no enrollment restriction
vacc <- readRDS('data/WA_DOH_Combined.rds')

#reported only with additonal cleaning and enrollment corrections
vaccReported <- readRDS("data/vaccReported")


#temp convenience
setwd("Udacity//dataAnalysisR/EDA_R_Udacity/EDA_R_FinalProject/")
#save.image("project_pause.RData")
load("project_pause.RData")
```

``` {r echo = FALSE ,alter data}
#limit fields
fields <- c("school_year", "school_code", "school_name", "school_type", "school_city","school_state", "school_zip", "school_county", "school_district", "district_code", "enrolled", "total_exemptions", "medical_exempt", "nonmedical_exempt", "exempt_MMR", "percent_exempt", "percent_medical_exempt","percent_nonmedexempt", "percent_exempt_MMR", "reported")


vacc <- subset(vacc, select = names(vacc) %in% fields)

vaccReported <- subset(vaccReported, na.rm = TRUE, select = fields )


```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}
#vacc
names(vacc)
str(vacc)
summary(vacc)

#investigate reporting

#counts of reported
table(vacc$reported)
#counts of repored for each year
with(vacc,table(school_year, reported))[,2:3]
#counts of reported for each school type
with(vacc,table(school_type, reported))[,2:3]
#counts of reported for each school type for each school year
with(vacc,table(school_type, reported, school_year))
#percent reported for each school type
prop.table(with(vacc,table(school_type, reported)),1)[,2:3]*100
#percent reported for each school type for each year
prop.table(with(vacc,table(school_type, reported,school_year == "2011")),c(1,3))[,2:3,2]*100
prop.table(with(vacc,table(school_type, reported,school_year == "2012")),c(1,3))[,2:3,2]*100
prop.table(with(vacc,table(school_type, reported,school_year == "2013")),c(1,3))[,2:3,2]*100

#do a size by proportion
ggplot(data = vacc, aes(x = reported, y = school_county)) +
  geom_point() +
  geom_jitter(aes(color_s = "school_type"))

#exemption rate vs enrollment
p = ggplot(vaccReported, aes(x = enrolled, y = percent_exempt)) + 
  geom_point(alpha = .4, aes(color = "red"))  
  
p1 = p +  geom_line(alpha = .5,stat = 'summary',fun.y = mean, linetype = 1, color = "black", size = 1) 

p2 = p1 + facet_wrap(~school_year)

p3 = p1 + geom_vline(xintercept = 2500, color="orange", size = 1) +
     geom_vline(xintercept = 2000, color="orange", size = 1)  
  

p4 = p3 + scale_x_continuous(limits = c(0, 2000), breaks = seq(0,2000,50))

p5 = p4 + geom_vline(xintercept = 100, color="orange", size = 1) +
  geom_vline(xintercept = 25, color="orange", size = 1)
  

p1
p2
p3
p4
p5





```

# Univariate Analysis

### What is the structure of your dataset?

### What is/are the main feature(s) of interest in your dataset?

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?

### Did you create any new variables from existing variables in the dataset?

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?



# Bivariate Plots Section
```{r echo=FALSE, Bivariate_Plots}

```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection


# References
